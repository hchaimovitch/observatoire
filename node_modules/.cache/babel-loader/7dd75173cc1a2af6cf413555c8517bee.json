{"ast":null,"code":"import _classCallCheck from \"C:\\\\work\\\\Project\\\\reactJs\\\\observatoire\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"C:\\\\work\\\\Project\\\\reactJs\\\\observatoire\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"C:\\\\work\\\\Project\\\\reactJs\\\\observatoire\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"C:\\\\work\\\\Project\\\\reactJs\\\\observatoire\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"C:\\\\work\\\\Project\\\\reactJs\\\\observatoire\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"C:\\\\work\\\\Project\\\\reactJs\\\\observatoire\\\\src\\\\components\\\\type\\\\chart.jsx\";\n//import './style.css';\nimport React from 'react';\nimport * as d3 from 'd3';\n\nvar Chart =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(Chart, _React$Component);\n\n  function Chart(props) {\n    var _this;\n\n    _classCallCheck(this, Chart);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Chart).call(this, props));\n    _this.state = {\n      data: '',\n      svgNodeRender: ''\n    };\n    return _this;\n  }\n\n  _createClass(Chart, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var that = this;\n      d3.json(\"./typologie.json\").then(function (json) {\n        var data = json;\n        console.log(\"data : \" + data);\n\n        var partition = function partition(data) {\n          return d3.partition().size([2 * Math.PI, radius])(d3.hierarchy(data).sum(function (d) {\n            return d.size;\n          }).sort(function (a, b) {\n            return b.value - a.value;\n          }));\n        };\n\n        var color = d3.scaleOrdinal().range(d3.quantize(d3.interpolateCubehelixDefault, data.children.length + 1));\n        var format = d3.format(\",d\");\n        var width = 932;\n        var radius = width / 2;\n        var arc = d3.arc().startAngle(function (d) {\n          return d.x0;\n        }).endAngle(function (d) {\n          return d.x1;\n        }).padAngle(function (d) {\n          return Math.min((d.x1 - d.x0) / 2, 0.005);\n        }).padRadius(radius / 2).innerRadius(function (d) {\n          return d.y0;\n        }).outerRadius(function (d) {\n          return d.y1 - 1;\n        });\n        var root = partition(data);\n        var svg = d3.select(\"#Type\").append(\"svg\").style(\"width\", \"900px\").style(\"height\", \"900px\").style(\"padding\", \"10px\").style(\"font\", \"10px sans-serif\").style(\"box-sizing\", \"border-box\");\n        var g = svg.append(\"g\");\n        g.append(\"g\").attr(\"fill-opacity\", 0.6).selectAll(\"path\").data(root.descendants().filter(function (d) {\n          return d.depth;\n        })).enter().append(\"path\").attr(\"fill\", function (d) {\n          while (d.depth > 1) {\n            d = d.parent;\n          }\n\n          return color(d.data.name);\n        }).attr(\"d\", arc).append(\"title\").text(function (d) {\n          return \"\".concat(d.ancestors().map(function (d) {\n            return d.data.name;\n          }).reverse().join(\"/\"), \"\\n\").concat(format(d.value));\n        });\n        g.append(\"g\").attr(\"pointer-events\", \"none\").attr(\"text-anchor\", \"middle\").selectAll(\"text\").data(root.descendants().filter(function (d) {\n          return d.depth && (d.y0 + d.y1) / 2 * (d.x1 - d.x0) > 10;\n        })).enter().append(\"text\").attr(\"transform\", function (d) {\n          var x = (d.x0 + d.x1) / 2 * 180 / Math.PI;\n          var y = (d.y0 + d.y1) / 2;\n          return \"rotate(\".concat(x - 90, \") translate(\").concat(y, \",0) rotate(\").concat(x < 180 ? 0 : 180, \")\");\n        }).attr(\"dy\", \"0.35em\").text(function (d) {\n          return d.data.name;\n        }); // test\n        //document.body.appendChild(svg.node());\n        //console.log( g.node() );\n        //const box = g.node().getBBox(); Bug with chrome\n\n        var box = g.node().getBoundingClientRect(); //console.log( \" box : \" + JSON.stringify(box) );\n\n        svg.attr(\"width\", box.width).attr(\"height\", box.height).attr(\"viewBox\", \"-650 -550 1200 1200\"); //`${box.x} ${box.y} ${box.width} ${box.height}`\n        //svg.node() replace by\n        //document.body.appendChild(svg.node());\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return React.createElement(\"div\", {\n        id: \"Type\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 96\n        },\n        __self: this\n      });\n    }\n  }]);\n\n  return Chart;\n}(React.Component);\n\nexport default Chart;","map":{"version":3,"sources":["C:\\work\\Project\\reactJs\\observatoire\\src\\components\\type\\chart.jsx"],"names":["React","d3","Chart","props","state","data","svgNodeRender","that","json","then","console","log","partition","size","Math","PI","radius","hierarchy","sum","d","sort","a","b","value","color","scaleOrdinal","range","quantize","interpolateCubehelixDefault","children","length","format","width","arc","startAngle","x0","endAngle","x1","padAngle","min","padRadius","innerRadius","y0","outerRadius","y1","root","svg","select","append","style","g","attr","selectAll","descendants","filter","depth","enter","parent","name","text","ancestors","map","reverse","join","x","y","box","node","getBoundingClientRect","height","Component"],"mappings":"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","sourcesContent":["//import './style.css';\r\nimport React from 'react';\r\nimport * as d3 from 'd3';\r\n\r\nclass Chart extends React.Component {\r\n    constructor(props) {\r\n        super(props)\r\n        this.state = {\r\n            data : '',\r\n            svgNodeRender : ''\r\n        };\r\n    }\r\n\r\n    componentDidMount() {\r\n        let that = this;\r\n        d3.json(\"./typologie.json\").then(function(json) {\r\n        \r\n            const data = json\r\n        \r\n            console.log(\"data : \" + data);\r\n              \r\n            const partition = data => d3.partition()\r\n                .size([2 * Math.PI, radius])(d3.hierarchy(data)\r\n                .sum(d => d.size)\r\n                .sort((a, b) => b.value - a.value));\r\n            const color = d3.scaleOrdinal().range(d3.quantize(d3.interpolateCubehelixDefault, data.children.length + 1));\r\n            const format = d3.format(\",d\");\r\n            const width = 932;\r\n            const radius = width / 2;\r\n            const arc = d3.arc()\r\n                .startAngle(d => d.x0)\r\n                .endAngle(d => d.x1)\r\n                .padAngle(d => Math.min((d.x1 - d.x0) / 2, 0.005))\r\n                .padRadius(radius / 2)\r\n                .innerRadius(d => d.y0)\r\n                .outerRadius(d => d.y1 - 1);\r\n\r\n            const root = partition(data);    \r\n         \r\n            const svg = d3.select(\"#Type\").append(\"svg\")\r\n                .style(\"width\", \"900px\")\r\n                .style(\"height\", \"900px\")\r\n                .style(\"padding\", \"10px\")\r\n                .style(\"font\", \"10px sans-serif\")\r\n                .style(\"box-sizing\", \"border-box\");\r\n            \r\n              \r\n            const g = svg.append(\"g\");\r\n            \r\n            g.append(\"g\")\r\n                .attr(\"fill-opacity\", 0.6)\r\n              .selectAll(\"path\")\r\n              .data(root.descendants().filter(d => d.depth))\r\n              .enter().append(\"path\")\r\n                .attr(\"fill\", d => { while (d.depth > 1) d = d.parent; return color(d.data.name); })\r\n                .attr(\"d\", arc)\r\n              .append(\"title\")\r\n                .text(d => `${d.ancestors().map(d => d.data.name).reverse().join(\"/\")}\\n${format(d.value)}`);\r\n          \r\n            g.append(\"g\")\r\n                .attr(\"pointer-events\", \"none\")\r\n                .attr(\"text-anchor\", \"middle\")\r\n              .selectAll(\"text\")\r\n              .data(root.descendants().filter(d => d.depth && (d.y0 + d.y1) / 2 * (d.x1 - d.x0) > 10))\r\n              .enter().append(\"text\")\r\n                .attr(\"transform\", function(d) {\r\n                  const x = (d.x0 + d.x1) / 2 * 180 / Math.PI;\r\n                  const y = (d.y0 + d.y1) / 2;\r\n                  return `rotate(${x - 90}) translate(${y},0) rotate(${x < 180 ? 0 : 180})`;\r\n                })\r\n                .attr(\"dy\", \"0.35em\")\r\n                .text(d => d.data.name);\r\n        \r\n\r\n                // test\r\n                //document.body.appendChild(svg.node());\r\n            \r\n                //console.log( g.node() );\r\n                \r\n                //const box = g.node().getBBox(); Bug with chrome\r\n                const box = g.node().getBoundingClientRect();\r\n        \r\n                //console.log( \" box : \" + JSON.stringify(box) );\r\n                       \r\n                svg\r\n                    .attr(\"width\", box.width) \r\n                    .attr(\"height\", box.height) \r\n                    .attr(\"viewBox\",\"-650 -550 1200 1200\" ); //`${box.x} ${box.y} ${box.width} ${box.height}`\r\n\r\n                //svg.node() replace by\r\n                //document.body.appendChild(svg.node());\r\n            });\r\n    }\r\n\r\n    render() {\r\n        return <div id=\"Type\"></div>\r\n        \r\n    }\r\n}\r\n\r\nexport default Chart;"]},"metadata":{},"sourceType":"module"}