{"ast":null,"code":"var _jsxFileName = \"C:\\\\work\\\\Project\\\\reactJs\\\\observatoire\\\\src\\\\components\\\\type\\\\chart.jsx\";\n//import './style.css';\nimport React from 'react';\nimport * as d3 from 'd3';\n\nfunction chart() {\n  /*\r\n  const url = \"./flare.json\";\r\n  d3.json(url, function (data) {\r\n      console.log(data);\r\n  });\r\n  console.log(d3.json(\"./flare.json\"));\r\n  */\n\n  /*\r\n  var promises = [];\r\n      promises.push(d3.json(\"./world-countries-no-antartica.json\"));\r\n  */\n  //const data = d3.json(\"./flare.json\");\n  // Promise Start\n  d3.json(\"./flare.json\").then(function (json) {\n    var _this = this;\n\n    var data = json;\n    console.log(\"data : \" + data);\n\n    var partition = function partition(data) {\n      return d3.partition().size([2 * Math.PI, radius])(d3.hierarchy(data).sum(function (d) {\n        return d.size;\n      }).sort(function (a, b) {\n        return b.value - a.value;\n      }));\n    };\n\n    var color = d3.scaleOrdinal().range(d3.quantize(d3.interpolateRainbow, data.children.length + 1));\n    var format = d3.format(\",d\");\n    var width = 932;\n    var radius = width / 2;\n    var arc = d3.arc().startAngle(function (d) {\n      return d.x0;\n    }).endAngle(function (d) {\n      return d.x1;\n    }).padAngle(function (d) {\n      return Math.min((d.x1 - d.x0) / 2, 0.005);\n    }).padRadius(radius / 2).innerRadius(function (d) {\n      return d.y0;\n    }).outerRadius(function (d) {\n      return d.y1 - 1;\n    });\n    var root = this.partition(data);\n    var svg = d3.select(\"#type\").style(\"width\", \"100%\").style(\"height\", \"auto\").style(\"padding\", \"10px\").style(\"font\", \"10px sans-serif\").style(\"box-sizing\", \"border-box\");\n    var g = svg.append(\"g\");\n    g.append(\"g\").attr(\"fill-opacity\", 0.6).selectAll(\"path\").data(root.descendants().filter(function (d) {\n      return d.depth;\n    })).enter().append(\"path\").attr(\"fill\", function (d) {\n      while (d.depth > 1) {\n        d = d.parent;\n      }\n\n      return _this.color(d.data.name);\n    }).attr(\"d\", this.arc).append(\"title\").text(function (d) {\n      return \"\".concat(d.ancestors().map(function (d) {\n        return d.data.name;\n      }).reverse().join(\"/\"), \"\\n\").concat(_this.format(d.value));\n    });\n    g.append(\"g\").attr(\"pointer-events\", \"none\").attr(\"text-anchor\", \"middle\").selectAll(\"text\").data(root.descendants().filter(function (d) {\n      return d.depth && (d.y0 + d.y1) / 2 * (d.x1 - d.x0) > 10;\n    })).enter().append(\"text\").attr(\"transform\", function (d) {\n      var x = (d.x0 + d.x1) / 2 * 180 / Math.PI;\n      var y = (d.y0 + d.y1) / 2;\n      return \"rotate(\".concat(x - 90, \") translate(\").concat(y, \",0) rotate(\").concat(x < 180 ? 0 : 180, \")\");\n    }).attr(\"dy\", \"0.35em\").text(function (d) {\n      return d.data.name;\n    });\n    document.body.appendChild(svg.node());\n    var box = g.node().getBBox();\n    svg.remove().attr(\"width\", box.width).attr(\"height\", box.height).attr(\"viewBox\", \"\".concat(box.x, \" \").concat(box.y, \" \").concat(box.width, \" \").concat(box.height));\n  }); // return svg.node();\n\n  return React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 89\n    },\n    __self: this\n  });\n}\n\n;\nexport default (function (props) {\n  // console.log('props' + JSON.stringify(props));\n  return chart();\n});","map":{"version":3,"sources":["C:\\work\\Project\\reactJs\\observatoire\\src\\components\\type\\chart.jsx"],"names":["React","d3","chart","json","then","data","console","log","partition","size","Math","PI","radius","hierarchy","sum","d","sort","a","b","value","color","scaleOrdinal","range","quantize","interpolateRainbow","children","length","format","width","arc","startAngle","x0","endAngle","x1","padAngle","min","padRadius","innerRadius","y0","outerRadius","y1","root","svg","select","style","g","append","attr","selectAll","descendants","filter","depth","enter","parent","name","text","ancestors","map","reverse","join","x","y","document","body","appendChild","node","box","getBBox","remove","height","props"],"mappings":"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","sourcesContent":["//import './style.css';\r\nimport React from 'react';\r\nimport * as d3 from 'd3';\r\n\r\nfunction chart () {\r\n    /*\r\n    const url = \"./flare.json\";\r\n    d3.json(url, function (data) {\r\n        console.log(data);\r\n    });\r\n    console.log(d3.json(\"./flare.json\"));\r\n    */\r\n\r\n    /*\r\n    var promises = [];\r\n        promises.push(d3.json(\"./world-countries-no-antartica.json\"));\r\n    */\r\n    //const data = d3.json(\"./flare.json\");\r\n    // Promise Start\r\n    d3.json(\"./flare.json\").then(function(json) {\r\n        \r\n    const data = json\r\n\r\n    console.log(\"data : \" + data);\r\n      \r\n    const partition = data => d3.partition()\r\n        .size([2 * Math.PI, radius])\r\n    (d3.hierarchy(data)\r\n        .sum(d => d.size)\r\n        .sort((a, b) => b.value - a.value));\r\n    const color = d3.scaleOrdinal().range(d3.quantize(d3.interpolateRainbow, data.children.length + 1));\r\n    const format = d3.format(\",d\");\r\n    const width = 932;\r\n    const radius = width / 2;\r\n    const arc = d3.arc()\r\n        .startAngle(d => d.x0)\r\n        .endAngle(d => d.x1)\r\n        .padAngle(d => Math.min((d.x1 - d.x0) / 2, 0.005))\r\n        .padRadius(radius / 2)\r\n        .innerRadius(d => d.y0)\r\n        .outerRadius(d => d.y1 - 1);\r\n        \r\n    const root = this.partition(data);      \r\n    const svg = d3.select(\"#type\")\r\n        .style(\"width\", \"100%\")\r\n        .style(\"height\", \"auto\")\r\n        .style(\"padding\", \"10px\")\r\n        .style(\"font\", \"10px sans-serif\")\r\n        .style(\"box-sizing\", \"border-box\");\r\n      \r\n    const g = svg.append(\"g\");\r\n    \r\n    g.append(\"g\")\r\n        .attr(\"fill-opacity\", 0.6)\r\n      .selectAll(\"path\")\r\n      .data(root.descendants().filter(d => d.depth))\r\n      .enter().append(\"path\")\r\n        .attr(\"fill\", d => { while (d.depth > 1) d = d.parent; return this.color(d.data.name); })\r\n        .attr(\"d\", this.arc)\r\n      .append(\"title\")\r\n        .text(d => `${d.ancestors().map(d => d.data.name).reverse().join(\"/\")}\\n${this.format(d.value)}`);\r\n  \r\n    g.append(\"g\")\r\n        .attr(\"pointer-events\", \"none\")\r\n        .attr(\"text-anchor\", \"middle\")\r\n      .selectAll(\"text\")\r\n      .data(root.descendants().filter(d => d.depth && (d.y0 + d.y1) / 2 * (d.x1 - d.x0) > 10))\r\n      .enter().append(\"text\")\r\n        .attr(\"transform\", function(d) {\r\n          const x = (d.x0 + d.x1) / 2 * 180 / Math.PI;\r\n          const y = (d.y0 + d.y1) / 2;\r\n          return `rotate(${x - 90}) translate(${y},0) rotate(${x < 180 ? 0 : 180})`;\r\n        })\r\n        .attr(\"dy\", \"0.35em\")\r\n        .text(d => d.data.name);\r\n  \r\n    document.body.appendChild(svg.node());\r\n  \r\n    const box = g.node().getBBox();\r\n  \r\n    svg.remove()\r\n        .attr(\"width\", box.width)\r\n        .attr(\"height\", box.height)\r\n        .attr(\"viewBox\", `${box.x} ${box.y} ${box.width} ${box.height}`);\r\n\r\n    });\r\n\r\n    // return svg.node();\r\n    return <div></div>;\r\n  };\r\n\r\n  export default (props) => {\r\n    // console.log('props' + JSON.stringify(props));\r\n     return chart()\r\n }"]},"metadata":{},"sourceType":"module"}